{% extends "base.html"%}
{% block body %}
<div class="login-page">
    <link rel="stylesheet" href="/static/auth/login.css">
    <center><input id="email-input" type="text" placeholder="Email"></center>
    <center><input id="password-input" type="password" placeholder="Password"></center>
    <button id="login-button">Войти</button>
</div>

<script type="text/javascript">
    let button = document.querySelector('#login-button')
    let emailInput = document.querySelector('#email-input')
    let passwordInput = document.querySelector('#password-input')

    button.onclick = async function () {
        let email = emailInput.value;
        let password = passwordInput.value;
        let request = {
            "jsonrpc": "2.0",
            "method": "login",
            "params": [{
                "email": email,
                "password": password
            }],
            "id": "login"
        };

        let response = await fetch('http://127.0.0.1:8080/api/v1/jsonrpc', {
            method: "POST",
            body: JSON.stringify(request)
        });
        let result = await response.json()
        console.log(result)
        if(result.result != null){
            window.location.replace("http://127.0.0.1:8080/")
        }
        else if(result.error){
            window.location.replace("http://127.0.0.1:8080/auth/login")
        }
    };
</script>
{% endblock %}